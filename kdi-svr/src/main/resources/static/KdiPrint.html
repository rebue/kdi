<!DOCTYPE html>
<html lang="en">
<head>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="no-cache,no-store, must-revalidate">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="expires" content="0">
<meta name="google" value="notranslate">
<meta charset="utf-8">
<title>订单打印</title>
<link href="KdiPrint.css" rel="stylesheet">
<script type="text/javascript" src="lib/jquery-3.3.1.min.js"></script>
<script type="text/javascript">

	
	$(document).ready(function() {
		// 加载省份
		selectSendProvinces();
		
		// 加载发件人信息
		senderInfo();
		
		// 加载物流公司
		getLogisticsCompany();
		
		//获取当前时间戳
		var timestamp = new Date().getTime();
		// 清除发件人信息
		$(document).on("click", "#clearSender", function() {
			clearSenderInfo();
		});
		
		// 清空收件人信息
		$(document).on("click", "#clearRecipient", function() {
		    $('#recipientFrom')[0].reset();
		    $("#selectRecipientCity").find("option").remove();
		    $("#selectRecipientCounty").find("option").remove();
		    $("#selectRecipientCity").append("<option>请选择</option>");
		    $("#selectRecipientCounty").append("<option>请选择</option>");
		});
		
		
		// 添加发件人
		$(document).on("click", "#addSenderButton", function() {
			// 发件人名称
			var senderName = $("#senderName").val().trim();
			// 发件人电话
			var senderTel = $("#senderTel").val().trim();
			// 发件人手机
			var senderMobile = $("#senderMobile").val().trim();
			// 发件省份
			var senderProvince = $("#selectSendProvinces").find("option:selected").text().trim();
			// 发件城市
			var senderCity = $("#selectSendCity").find("option:selected").text().trim();
			// 发件区县
			var senderExpArea = $("#selectSendCounty").find("option:selected").text().trim();
			// 发件详细地址
			var senderAddress = $("#senderAddress").val().trim();
			// 发件地邮编
			var senderPostCode = $("#senderPostCode").val().trim();
			// 是否为默认收货地址
			var isDefault = false;
			var statue = document.getElementById("isDefault");
			console.log(statue.checked);
			if(statue.checked) {
				isDefault = true;
			}

			if (senderName == null || senderName == "" || senderName == "null") {
				alert("发件人不能为空");
				return;
			}
			if (senderProvince == null || senderProvince == "" || senderProvince == "null") {
				alert("发件省份不能为空");
				return;
			}
			if (senderCity == null || senderCity == "" || senderCity == "null") {
				alert("发件城市不能为空");
				return;
			}
			if (senderExpArea == null || senderExpArea == "" || senderExpArea == "null") {
				alert("发件区/县不能为空");
				return;
			}
			if (senderAddress == null || senderAddress == "" || senderAddress == "null") {
				alert("发件详细地址不能为空");
				return;
			}
			if (senderPostCode == null || senderPostCode == "" || senderPostCode == "null") {
				alert("发件地邮编不能为空");
				return;
			}
			console.log("senderTel == " + senderTel);
			console.log("senderMobile == " + senderMobile);
			if (senderTel.length == 0 && senderMobile.length == 0) {
				alert("发件人电话和手机必须填一个");
				return;
			}
			$.ajax({
				type : "post",
				url : "/kdi/sender/add",
				dataType : "json",
				data : {
					senderName : senderName,
					senderTel : senderTel,
					senderMobile : senderMobile,
					senderProvince : senderProvince,
					senderCity : senderCity,
					senderExpArea : senderExpArea,
					senderAddress : senderAddress,
					senderPostCode : senderPostCode,
					isDefault : isDefault
				}
			}).done(function(data) {
				alert(data.msg);
				window.location.reload();
			});
		});
		
		// 全选/取消全选发件人
		$(document).on("click", "#checkAll", function() {
			if ($("#checkAll").prop('checked')) {
				$("input[name='senderIsDefault']").attr("checked", true);
			} else {
				$("input[name='senderIsDefault']").attr("checked", false);
				clearSenderInfo();
			}
		});
		
		// 清空已选择的发件人
		$(document).on("click", "#clearSenderChoice", function() {
			$("input[name='senderIsDefault']").attr("checked", false);	
			clearSenderInfo();
		});
		
		// 修改发件人信息
		$(document).on("click", "#modifySenderInfo", function() {
			// 发件人名称
			var senderName = $("#senderName").val().trim();
			// 发件人电话
			var senderTel = $("#senderTel").val().trim();
			// 发件人手机
			var senderMobile = $("#senderMobile").val().trim();
			// 发件省份
			var senderProvince = $("#selectSendProvinces").find("option:selected").text().trim();
			// 发件城市
			var senderCity = $("#selectSendCity").find("option:selected").text().trim();
			// 发件区县
			var senderExpArea = $("#selectSendCounty").find("option:selected").text().trim();
			// 发件详细地址
			var senderAddress = $("#senderAddress").val().trim();
			// 发件地邮编
			var senderPostCode = $("#senderPostCode").val().trim();
			// 发件人ID
			var senderId = $("#senderId").val().trim();
			console.log(senderId);
			// 是否为默认收货地址
			var isDefault = false;
			var statue = document.getElementById("isDefault");
			if(statue.checked) {
				isDefault = true;
			}
			if(senderId == 0) {
				alert("该发件人未保存, 无需修改");
				return ;
			}
			if (senderName == null || senderName == "" || senderName == "null") {
				alert("发件人不能为空");
				return;
			}
			if (senderProvince == null || senderProvince == "" || senderProvince == "null") {
				alert("发件省份不能为空");
				return;
			}
			if (senderCity == null || senderCity == "" || senderCity == "null") {
				alert("发件城市不能为空");
				return;
			}
			if (senderExpArea == null || senderExpArea == "" || senderExpArea == "null") {
				alert("发件区/县不能为空");
				return;
			}
			if (senderAddress == null || senderAddress == "" || senderAddress == "null") {
				alert("发件详细地址不能为空");
				return;
			}
			if (senderPostCode == null || senderPostCode == "" || senderPostCode == "null") {
				alert("发件地邮编不能为空");
				return;
			}
			if (senderTel.length == 0 && senderMobile.length == 0) {
				alert("发件人电话和手机必须填一个");
				return;
			}
			$.ajax({
				type : "put",
				url : "/kdi/sender",
				dataType : "json",
				data : {
					id : senderId,
					senderName : senderName,
					senderTel : senderTel,
					senderMobile : senderMobile,
					senderProvince : senderProvince,
					senderCity : senderCity,
					senderExpArea : senderExpArea,
					senderAddress : senderAddress,
					senderPostCode : senderPostCode,
					isDefault : isDefault
				}
			}).done(function(data) {
				alert(data.msg);
				window.location.reload();
			});
		});
		
		// 选中后将发件人信息填写至寄件人信息
		$(document).on("click", ".senderCheckbox", function() {
			var obj = $(this).parent();
			console.log(obj[0].cells[0].childNodes[1].id);
			var strs = new Array();
			// 根据逗号获取图片后缀
			strs = obj[0].cells[4].innerHTML.split(" "); 
			console.log(strs);
			// 发件人名称
			$("#senderName").val(obj[0].cells[1].innerHTML);
			if(strs.length == 7) {
				// 发件人电话
				$("#senderTel").val(strs[6]);
			}
			// 发件人手机
			$("#senderMobile").val(strs[5]);
			// 发件省份
			$("#selectSendProvinces").find("option:selected").text(strs[0]);
			// 发件城市
			$("#selectSendCity").find("option:selected").text(strs[1]);
			// 发件区县
			$("#selectSendCounty").find("option:selected").text(strs[2]);
			// 发件详细地址
			$("#senderAddress").val(strs[3]);
			// 发件地邮编
			$("#senderPostCode").val(strs[4]);
			// 发件人Id
			$("#senderId").val(obj[0].cells[0].childNodes[1].id);
			$("#isDefault").prop("checked","checked");
			$("#senderIsDefault").prop("checked","checked");
		});
		
		// 设为默认发件人
		$(document).on("click", "#setDefaultSender", function() {
			var str = document.getElementsByName("senderIsDefault");
			var checkboxArray = new Array();
			for (var i = 0; i < str.length; i++) {
				if(str[i].checked == true) {
					checkboxArray.push({
						id : str[i].id
					});
					console.log("选中" + str[i].id);
				}
			}
			console.log(checkboxArray);
			if(checkboxArray.length == 0) {
				alert("您还没有选择任何数据");
				return ;
			}
			if(checkboxArray.length > 1) {
				alert("默认发件人只能有一个");
				return ;
			}
			$.ajax({
				type : "put",
				url : "/kdi/sender/default",
				dataType : "json",
				data : {
					id : checkboxArray[0].id,
					isDefault : true
				}
			}).done(function(data) {
				alert(data.msg);
				window.location.reload();
			});
		});
		
		// 删除发件人
		$(document).on("click", "#deleteSender", function() {
			var is=window.confirm('确定删除吗？');
			if(!is){
				return;
			}
			var obj = $(this).parent().parent();
			console.log(obj[0].cells[2].innerHTML);
			console.log("参数:"+obj[0].cells[0].childNodes[2].value);
			$.ajax({
				type : "delete",
				url : "/kdi/sender/" + obj[0].cells[0].childNodes[2].value,
				dataType : "json",
			}).done(function(data) {
				alert(data.msg);
				window.location.reload();
			});
		});
		
		// 添加订单
		$(document).on("click", "#printExpress", function() {
			var shipperId			= 	$("#selectLogisticsCompany option:selected").data("id");	// 物流公司ID
			var shipperCode				=	$("#selectLogisticsCompany").val().trim();					// 物流公司编号
			var shipperName			=	$("#selectLogisticsCompany option:selected").text(); 		// 物流公司名称
			var orderTitle 			= 	$("#orderTitle").val().trim(); 						// 订单标题
			var orderDetail 			= 	$("#orderDetail").val().trim(); 						// 订单详情
			var senderName 			= 	$("#senderName").val().trim(); 						// 发件人名称
			var senderTel 				= 	$("#senderTel").val().trim(); 						// 发件人电话
			var senderMobile			= 	$("#senderMobile").val().trim();						// 发件人手机
			var senderProvince		=	$("#selectSendProvinces").val().trim();			// 发件省份
			var senderCity				=	$("#selectSendCity").val().trim();					// 发件城市
			var senderExpArea			=	$("#selectSendCounty").val().trim();				// 发件区县
			var senderAddress			=	$("#senderAddress").val().trim();					// 发件详细地址
			var senderPostCode		= 	$("#senderPostCode").val().trim();					//	发件地址邮编
			var receiverName 			= 	$("#receiverName").val().trim(); 					// 收件人名称
			var receiverTel 			= 	$("#receiverTel").val().trim(); 						// 收件人电话
			var receiverMobile 		= 	$("#receiverMobile").val().trim(); 					// 收件人手机
			var receiverProvince 	= 	$("#selectRecipientProvinces option:selected").text().trim(); 	// 收件省份
			var receiverCity 			= 	$("#selectRecipientCity option:selected").text().trim(); 		// 收件城市
			var receiverExpArea 		= 	$("#selectRecipientCounty option:selected").text().trim(); 		// 收件区县
			var receiverAddress 		= 	$("#receiverAddress").val().trim(); 				// 收件人详细地址
			var receiverPostCode 	= 	$("#receiverPostCode").val().trim(); 				// 收件地址邮编
			if (shipperCode == null || shipperCode == "" || shipperCode == "null") {
				alert("请选择物流公司");
				return ;
			}
			if (orderTitle == null || orderTitle == "" || orderTitle == "null") {
				alert("订单标题不能为空");
				return;
			}
			if	(senderName == null || senderName == "" || senderName == "null") {
				alert("发件人不能为空");
				return ;
			}
			if (senderMobile.length == 0 && senderTel.length == 0) {
				alert("发件人手机或电话号码必须填一个");
				return ;
			}
			if (senderProvince == null || senderProvince == "" || senderProvince == "null") {
				alert("发件省份不能为空");
				return ;
			}
			if	(senderCity == null || senderCity == "" || senderCity == "null") {
				alert("发件城市不能为空");
				return ;
			}
			if	(senderExpArea == null || senderExpArea == "" || senderExpArea == "null") {
				alert("发件区/县/直辖镇不能为空");
				return ;
			}
			if (senderAddress == null || senderAddress == "" || senderAddress == "null") {
				alert("发件详细地址不能为空");
				return ;
			}
			if	(senderPostCode == null || senderPostCode == "" || senderPostCode == "null") {
				alert("发件地址邮编不能为空");
				return ;
			}
			if (receiverName == null || receiverName == "" || receiverName == "null") {
				alert("收件人名称不能为空");
				return;
			}
			if (receiverProvince == null || receiverProvince == "" || receiverProvince == "null") {
				alert("收件省份不能为空");
				return;
			}
			if (receiverCity == null || receiverCity == "" || receiverCity == "null") {
				alert("收件城市不能为空");
				return;
			}
			if (receiverExpArea == null || receiverExpArea == "" || receiverExpArea == "null") {
				alert("收件区/县不能为空");
				return;
			}
			if (receiverAddress == null || receiverAddress == "" || receiverAddress == "null") {
				alert("收件详细地址不能为空");
				return;
			}
			if (receiverPostCode == null || receiverPostCode == "" || receiverPostCode == "null") {
				alert("收件地址邮编不能为空");
				return;
			}
			if (receiverTel.length == 0 && receiverMobile.length == 0) {
				alert("收件人手机和电话必须填写一个");
				return;
			}
			
			$.ajax({
				type : "post",
				url : "/kdi/eorder",
				dataType : "json",
				contentType: "application/json",
				data : JSON.stringify({
					shipperCode 	:	shipperCode,
					shipperId		:	shipperId,
					shipperName		:	shipperName,
					orderTitle		:	orderTitle,
					orderDetail		:	orderDetail,
					senderName		: 	senderName,
					senderTel		:	senderTel,
					senderMobile	:	senderMobile,
					senderProvince	:	senderProvince,
					senderCity		:	senderCity,
					senderExpArea	:	senderExpArea,
					senderAddress	:	senderAddress,
					senderPostCode	:	senderPostCode,
					receiverName	:	receiverName,
					receiverTel		:	receiverTel,
					receiverMobile	:	receiverMobile,
					receiverProvince	:	receiverProvince,
					receiverCity		:	receiverCity,
					receiverExpArea	:	receiverExpArea,
					receiverAddress	:	receiverAddress,
					receiverPostCode	:	receiverPostCode,
					orderId : timestamp
				})
				
			}).done(function(data) {
				console.log(data);
				if (data.result != 1) {
					alert(data.msg);
					return;
				}
				timestamp = new Date().getTime();
				var printPage = data.printPage;
				var printWindow = window.open();
				printWindow.document.body.innerHTML = printPage;
				printWindow.print();
				printWindow.close();
				
			});
		});
		
		// 录入快递单
		$(document).on("click", "#entryExpress", function() {
			var logisticCode			= 	$("#logisticCode").val().trim();						// 物流订单号
			var shipperId				= 	$("#selectLogisticsCompany option:selected").data("id");	// 物流公司编码
			var shipperCode			=	$("#selectLogisticsCompany").val().trim();					// 物流公司编号
			var shipperName			=	$("#selectLogisticsCompany option:selected").text(); 		// 物流公司名称
			var orderTitle 			= 	$("#orderTitle").val().trim(); 						// 订单标题
			var orderDetail 			= 	$("#orderDetail").val().trim(); 						// 订单详情
			var senderName 			= 	$("#senderName").val().trim(); 						// 发件人名称
			var senderTel 				= 	$("#senderTel").val().trim(); 						// 发件人电话
			var senderMobile			= 	$("#senderMobile").val().trim();						// 发件人手机
			var senderProvince		=	$("#selectSendProvinces").val().trim();			// 发件省份
			var senderCity				=	$("#selectSendCity").val().trim();					// 发件城市
			var senderExpArea			=	$("#selectSendCounty").val().trim();				// 发件区县
			var senderAddress			=	$("#senderAddress").val().trim();					// 发件详细地址
			var senderPostCode		= 	$("#senderPostCode").val().trim();					//	发件地址邮编
			var receiverName 			= 	$("#receiverName").val().trim(); 					// 收件人名称
			var receiverTel 			= 	$("#receiverTel").val().trim(); 						// 收件人电话
			var receiverMobile 		= 	$("#receiverMobile").val().trim(); 					// 收件人手机
			var receiverProvince 	= 	$("#selectRecipientProvinces option:selected").text().trim(); 	// 收件省份
			var receiverCity 			= 	$("#selectRecipientCity option:selected").text().trim(); 		// 收件城市
			var receiverExpArea 		= 	$("#selectRecipientCounty option:selected").text().trim(); 		// 收件区县
			var receiverAddress 		= 	$("#receiverAddress").val().trim(); 				// 收件人详细地址
			var receiverPostCode 	= 	$("#receiverPostCode").val().trim(); 				// 收件地址邮编
			if	(logisticCode == null || logisticCode == "" || logisticCode == "null") {
				alert("请填写物流单号后再操作");
				return ;
			}
			if (shipperCode == null || shipperCode == "" || shipperCode == "null") {
				alert("请选择物流公司");
				return ;
			}
			if (orderTitle == null || orderTitle == "" || orderTitle == "null") {
				alert("订单标题不能为空");
				return;
			}
			if	(senderName == null || senderName == "" || senderName == "null") {
				alert("发件人不能为空");
				return ;
			}
			if (senderMobile.length == 0 && senderTel.length == 0) {
				alert("发件人手机或电话号码必须填一个");
				return ;
			}
			if (senderProvince == null || senderProvince == "" || senderProvince == "null") {
				alert("发件省份不能为空");
				return ;
			}
			if	(senderCity == null || senderCity == "" || senderCity == "null") {
				alert("发件城市不能为空");
				return ;
			}
			if	(senderExpArea == null || senderExpArea == "" || senderExpArea == "null") {
				alert("发件区/县/直辖镇不能为空");
				return ;
			}
			if (senderAddress == null || senderAddress == "" || senderAddress == "null") {
				alert("发件详细地址不能为空");
				return ;
			}
			if	(senderPostCode == null || senderPostCode == "" || senderPostCode == "null") {
				alert("发件地址邮编不能为空");
				return ;
			}
			if (receiverName == null || receiverName == "" || receiverName == "null") {
				alert("收件人名称不能为空");
				return;
			}
			if (receiverProvince == null || receiverProvince == "" || receiverProvince == "null") {
				alert("收件省份不能为空");
				return;
			}
			if (receiverCity == null || receiverCity == "" || receiverCity == "null") {
				alert("收件城市不能为空");
				return;
			}
			if (receiverExpArea == null || receiverExpArea == "" || receiverExpArea == "null") {
				alert("收件区/县不能为空");
				return;
			}
			if (receiverAddress == null || receiverAddress == "" || receiverAddress == "null") {
				alert("收件详细地址不能为空");
				return;
			}
			if (receiverPostCode == null || receiverPostCode == "" || receiverPostCode == "null") {
				alert("收件地址邮编不能为空");
				return;
			}
			if (receiverTel.length == 0 && receiverMobile.length == 0) {
				alert("收件人手机和电话必须填写一个");
				return;
			}
			$.ajax({
				type : "post",
				url : "/kdi/logistic/entry",
				dataType : "json",
				data : {
					logisticCode	:	logisticCode,
					shipperCode 	:	shipperCode,
					shipperId		:	shipperId,
					shipperName		:	shipperName,
					orderTitle		:	orderTitle,
					orderDetail		:	orderDetail,
					senderName		: 	senderName,
					senderTel		:	senderTel,
					senderMobile	:	senderMobile,
					senderProvince	:	senderProvince,
					senderCity		:	senderCity,
					senderExpArea	:	senderExpArea,
					senderAddress	:	senderAddress,
					senderPostCode	:	senderPostCode,
					receiverName	:	receiverName,
					receiverTel		:	receiverTel,
					receiverMobile	:	receiverMobile,
					receiverProvince	:	receiverProvince,
					receiverCity		:	receiverCity,
					receiverExpArea	:	receiverExpArea,
					receiverAddress	:	receiverAddress,
					receiverPostCode	:	receiverPostCode
				}
			}).done(function(data) {
				alert(data.msg);
			//	location.reload();
			});
		});
	});
	
	// 清除发件人信息
	function clearSenderInfo() {
		$('#senderFrom')[0].reset();
		$("#selectSendProvinces").find("option")[0].remove();
		$("#selectSendCity").find("option").remove();
		$("#selectSendCounty").find("option").remove();
		$("#selectSendProvinces").append('<option selected="selected">请选择</option>');
		$("#selectSendCity").append("<option>请选择</option>");
		$("#selectSendCounty").append("<option>请选择</option>");
	}
	
	// 选择省份
	function selectSendProvinces() {
		$.ajax({
			type : "get",
			url : "http://127.0.0.1:20081/are/area/provinceall",
			dataType : "json",
		}).done(function(data) {
			console.log(data);
			var html = '';
			for (var i = 0; i < data.length; i++) {
				html += '<option data-value = "' + data[i].areaName + '" value ="' + data[i].areaCode + '">' + data[i].areaName + '</option>';
			}
			$("#selectSendProvinces").append(html);
			$("#selectRecipientProvinces").append(html);
		});
	}
	
	// ===================================发件人==================================
	// 选择城市
	function getSendCity() {
		var selectSendProvinces = $("#selectSendProvinces").val();
		console.log(selectSendProvinces);
		$("#selectSendCity").find("option").remove(); 
		// 根据区域编号获取所有下级区域信息
		getAllLowerArea(selectSendProvinces, 1);
	}
	
	// 选择区县/直辖镇
	function getSendCounty() {
		var selectSendProvinces = $("#selectSendCity").val();
		$("#selectSendCounty").find("option").remove();
		console.log(selectSendCity);
		// 根据区域编号获取所有下级区域信息
		getAllLowerArea(selectSendProvinces, 2);
	}
	// ==================================发件人===================================
	
	// ==================================收件人===================================
	// 选择城市
	function getRecipientCity() {
		var selectRecipientProvinces = $("#selectRecipientProvinces").val();
		console.log(selectRecipientProvinces);
		$("#selectRecipientCity").find("option").remove();
		// 根据区域编号获取所有下级区域信息
		getAllLowerArea(selectRecipientProvinces, 3);
	}
	
	// 选择区县/直辖镇
	function getRecipientCounty() {
		var selectRecipientCity = $("#selectRecipientCity").val();
		$("#selectRecipientCounty").find("option").remove();
		console.log(selectRecipientCity);
		// 根据区域编号获取所有下级区域信息
		getAllLowerArea(selectRecipientCity, 4);
	}
	// ================================发件人=======================================
	
	// 根据编号获取所有下级区域信息
	function getAllLowerArea(areaCode, areaType) {
		$.ajax({
			type : "get",
			url : "http://127.0.0.1:20081/are/area/lowerareaall",
			dataType : "json",
			data : {areaCode : areaCode}
		}).done(function(data) {
			console.log(data);
			var html = '';
			for (var i = 0; i < data.length; i++) {
				html += '<option data-value = "' + data[i].areaName + '" value ="' + data[i].areaCode + '">' + data[i].areaName + '</option>';
			}
			
			if(areaType == 1) {
				$("#selectSendCity").append(html);
				$("#selectSendCounty").find("option").remove();
				getAllLowerArea(data[0].areaCode, 2);
			}
			
			if(areaType == 2) {
				$("#selectSendCounty").append(html);
			}
			
			if(areaType == 3) {
				$("#selectRecipientCity").append(html);
				$("#selectRecipientCounty").find("option").remove();
				getAllLowerArea(data[0].areaCode, 4);
			}
			
			if(areaType == 4) {
				$("#selectRecipientCounty").append(html);
			}
		});
	}
	
	// 查询发件人信息
	function senderInfo() {
		$.ajax({
			type : "get",
			url : "/kdi/sender",
			dataType : "json",
		}).done(function(data) {
			console.log(data);
			var html = '';
			if(data.length != 0) {console.log(789);
				$("#removeSenderNoData").remove();
			}
			for (var i = 0; i < data.length; i++) {
				html += '<tr>';
				html += '	<td class="senderCheckbox">';
				if(data[i].isDefault == 1) {
					html += '		<input id="' + data[i].id + '" name="senderIsDefault" checked="checked" type="checkbox">';
				} else {
					html += '		<input id="' + data[i].id + '" name="senderIsDefault" type="checkbox">';
				}
				html += '<input type="hidden" value="'+data[i].id+ '">';
				html += '	</td>';
				html += '	<td class="">' + data[i].senderName + '</td>';
				html += '	<td  class=""></td>';
				html += '	<td class="">' + data[i].senderProvince + ' ' + data[i].senderCity + ' ' +  data[i].senderExpArea + '</td>';
				html += '	<td class="">' + data[i].senderProvince + ' ' +  data[i].senderCity + ' ' +  data[i].senderExpArea + ' ' +  data[i].senderAddress + " " + data[i].senderPostCode + ' ' +  data[i].senderMobile + '' + data[i].senderTel + '</td>';
				html += '	<td class=""><button type="button" id="deleteSender" class="ant-btn"><span>删除</span></button></td>';
				html += '</tr>';
				if(data[i].isDefault == 1) {
					// 发件人名称
					$("#senderName").val(data[i].senderName);
					// 发件人电话
					$("#senderTel").val(data[i].senderTel);
					// 发件人手机
					$("#senderMobile").val(data[i].senderMobile);
					// 发件省份
					$("#selectSendProvinces").find("option:selected").text(data[i].senderProvince);
					// 发件城市
					$("#selectSendCity").find("option:selected").text(data[i].senderCity);
					// 发件区县
					$("#selectSendCounty").find("option:selected").text(data[i].senderExpArea);
					// 发件详细地址
					$("#senderAddress").val( data[i].senderAddress);
					// 发件地邮编
					$("#senderPostCode").val( data[i].senderPostCode);
					// 发件人Id
					$("#senderId").val(data[i].id);
					$("#isDefault").prop("checked","checked");
					$("#senderIsDefault").prop("checked","checked");
				}
			}
			$("#getSenderInfo").append(html);
		});
	}
	
	//上传文件
	function fileUpload(){
		console.log("文件上传");
	  var formData = new FormData($('#uploadForm')[0]);  
		$.ajax({
			type : "post",
			url : "/kdi/excel",
			dataType : "json",
			data : formData,
			processData: false,
			contentType: false
		}).done(function(data) {
			if(data.list==null){
				return;
			}
			console.log(data);
			var  html="";
			for (var i = 1; i < data.list.length; i++) {
				html+="<tr>";
				html+='<td> <input type="checkbox" /> </td>';
				for (var j = 0; j < data.list[i].length; j++) {
					if(j==12){
						html+='<td>'+data.list[i][j]+'</td>';
					}
					if(j==21){
						html+='<td>'+data.list[i][j]+'</td>';
					}
					if(j==22){
						html+='<td>'+data.list[i][j]+'</td>';
					}
					if(j==27){
						html+='<td>'+data.list[i][j]+'</td>';
					}
				}
				html+='<td> <a href="javascript:void(0);" onclick="delReceiverInfo(this);" >删除</a> </td>'
				html+="</tr>";
			}
			$("#receiverInfo").append(html);			
		})
	}
	
	// 删除发件人信息的页面数据，不删除数据库数据。
	function delReceiverInfo(thisdel){
		var is =window.confirm('确定删除');
		if(!is){
			return;
		}
		thisdel.parentNode.parentNode.parentNode.removeChild(thisdel.parentNode.parentNode);
	}
	
	// 获取所有物流公司信息
	function getLogisticsCompany() {
		$.ajax({
			type : "get",
			url : "/kdi/company",
			dataType : "json",
		}).done(function(data) {
			console.log(data);
			$("#selectLogisticsCompany").html('<option value ="">请选择</option>');
			var html = '';
			for (var i = 0; i < data.length; i++) {
				html += '<option data-id="' + data[i].id + '" value ="' + data[i].id + '">' + data[i].companyName + '</option>';
			}
			$("#selectLogisticsCompany").append(html);
		});
	}

</script>

<style type="text/css">
.file {
    position: relative;
    display: inline-block;
    background: #f7f7f7; 
    border: 1px solid #99D3F5;
    border-radius: 4px;
    padding: 4px 12px;
    overflow: hidden;
    color: #1E88C7;
    text-decoration: none;
    text-indent: 0;
    line-height: 20px;
}
.file input {
    position: absolute;
    font-size: 100px;
    right: 0;
    top: 0;
    opacity: 0;
   
}
.file:hover {
    background: #AADFFD;
    border-color: #78C3F3;
    color: #004974;
    text-decoration: none;
}
</style>
</head>
<body>
	<div id="root">
		<div data-reactroot="" class="layout-normal">
			<div class="layout-header">
				<div class="layout-header-info-container">
					<div class="layout-header-info">
						<div class="ant-row">
							<div class="ant-col-3"></div>
							<div class="ant-col-13">
								<ul class="ant-menu ant-menu-horizontal ant-menu-dark ant-menu-root" role="menu" aria-activedescendant="" tabindex="0">
									<li class="ant-menu-item" role="menuitem" aria-selected="false"><a href="KdiManage.html">首页</a></li>
									<li class="ant-menu-item-selected ant-menu-item" role="menuitem" aria-selected="true"><a href="KdiPrint.html">打印</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="layout-content">
				<div class="layout-content-inner">
					<div class="ant-row">
						<div class="ant-col-12 leftCol">
							<div>
								<div class="customPrint-form-div">
									<div class="ant-row info-header-row">
										<div class="ant-col-1"></div>
										<div class="ant-col-6">
											<div>修改寄件人信息</div>
										</div>
									</div>
									<form class="ant-form ant-form-horizontal" id="senderFrom">
										<div class="ant-row info-row">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="name" class="" title="寄件人姓名">寄件人姓名</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="senderName" class="ant-input ant-input-lg" type="text">
															<div style="display: none;">
																<input id="senderId">
															</div>
														</div>
													</div>
												</div>
											</div>
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="phone" class="" title="电话">电话</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="senderTel" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="mobilePhone" class="" title="手机">手机</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="senderMobile" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="zipCode" class="" title="邮编">邮编</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="senderPostCode" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-24 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-5 ant-form-item-label">
														<label for="provinceCityCountry" class="" title="寄件人地址">寄件人地址</label>
													</div>
													<div class="ant-col-19 ant-form-item-control-wrapper">
														<div class="ant-form-item-control has-success">
															<div style="display: inline-block;">
																<select id="selectSendProvinces" style="height: 33px" onchange="getSendCity()">
																	<option>请选择</option>
																</select>
																<select id="selectSendCity" style="height: 33px" onchange="getSendCounty()">
																	<option>请选择</option>
																</select>
																<select id="selectSendCounty" style="height: 33px">
																	<option>请选择</option>
																</select>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-24 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-5 ant-form-item-label">
														<label for="addr" class="ant-form-item-required" title="详细地址">详细地址</label>
													</div>
													<div class="ant-col-19 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input id="senderAddress" value="" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row">
											<div class="ant-col-24 last-info-col">
												<div class="ant-col-4 last-info-col"></div>
												<div class="ant-col-6">
													<label class="ant-checkbox-wrapper">
														<span class="ant-checkbox">
															<input id="isDefault" type="checkbox">
														</span>
														<span style="font-size: 14px">是否是默认寄件人</span>
													</label>
												</div>
												<div class="ant-col-5 last-info-col">
													<button type="button" id="addSenderButton" class="ant-btn ant-btn-primary ant-btn-sm">
														<span>新增寄件人记录</span>
													</button>
												</div>
												<div class="ant-col-7 last-info-col">
													<button id="modifySenderInfo" type="button" class="ant-btn ant-btn-default ant-btn-sm">
														<span>修改寄件人记录</span>
													</button>
												</div>
												<div class="ant-col-2 last-info-col">
													<button type="button" id="clearSender" class="ant-btn ant-btn-primary ant-btn-sm">
														<span>清 空</span>
													</button>
												</div>
											</div>
										</div>
									</form>
								</div>
								<div class="senderAndReceiverTable-div">
									<div>
										<div class="ant-table-wrapper">
											<div class="ant-spin-nested-loading">
												<div class="ant-spin-container">
													<div class="ant-table ant-table-large ant-table-bordered ant-table-empty ant-table-fixed-header ant-table-scroll-position-left">
														<div class="ant-table-content">
															<div class="ant-table-scroll">
																<div class="ant-table-header" style="margin-bottom: -10px; padding-bottom: 0px;">
																	<table class="ant-table-fixed" style="table-layout: fixed;">
																		<colgroup>
																			<col style="width: 16px; min-width: 16px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 200px; min-width: 200px;">
																			<col style="width: 60px; min-width: 60px;">
																		</colgroup>
																		<thead class="ant-table-thead">
																			<tr>
																				<th>
																					<input id="checkAll" type="checkbox">
																				</th>
																				<th class=""><span>寄件人姓名</span></th>
																				<th class=""><span>卖家ID</span></th>
																				<th class=""><span>寄件人单位</span></th>
																				<th class=""><span>寄件人信息</span></th>
																				<th class=""><span>操作</span></th>
																			</tr>
																		</thead>
																	</table>
																</div>
																<div class="ant-table-body"
																	style="overflow-x: auto; max-height: 200px; overflow-y: scroll;">
																	<table class="ant-table-fixed"
																		style="table-layout: fixed;">
																		<colgroup>
																			<col style="width: 16px; min-width: 16px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 200px; min-width: 200px;">
																			<col style="width: 60px; min-width: 60px;">
																		</colgroup>
																		<tbody class="ant-table-tbody" id="getSenderInfo"></tbody>
																	</table>
																</div>
																<div class="ant-table-placeholder"  id="removeSenderNoData">
																	<span><i class="anticon anticon-frown-o"></i>暂无数据</span>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div>
										<div class="ant-row">
											<div class="ant-col-3">
												<button type="button" id="setDefaultSender" class="ant-btn ant-btn-primary ant-btn-sm">
													<span>设为默认</span>
												</button>
											</div>
											<div class="ant-col-12">
												<button type="button" id="clearSenderChoice" class="ant-btn ant-btn-primary ant-btn-sm">
													<span>清空选择</span>
												</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="ant-col-12 rightCol">
							<div>
								<div class="customPrint-form-div">
									<div class="ant-row info-header-row">
										<div class="ant-col-1"></div>
										<div class="ant-col-6">
											<div>修改收件人信息</div>
										</div>
										<div class="ant-col-3 ant-col-push-11" style="width:28.5%; ">
											<form id="uploadForm" enctype="multipart/form-data" > 
												<a  class="file">
												选择文件
													<input type="file" name="filename" id="upFile" onchange="fileUpload();" />
												</a>
											</form>
										</div>
									</div>
									<form id="recipientFrom" class="ant-form ant-form-horizontal">
										<div class="ant-row info-row">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="company" class="" title="订单标题">订单标题</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="orderTitle" class="ant-input ant-input-lg" style="width: 468px" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row" style="margin-left: -2px;">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="zipCode" class="" title="订单详情">订单详情</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<textarea value="" id="orderDetail" placeholder="选填" class="ant-input ant-input-lg" style="min-width: 468px;" type="text"></textarea>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row" style="margin-top: 40px">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="nick" class="" title="收件人名称">收件人名称</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="receiverName" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="mobilePhone" class="" title="手机">手机</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="receiverMobile" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="phone" class="" title="电话">电话</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="" id="receiverTel" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
											<div class="ant-col-12 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-10 ant-form-item-label">
														<label for="zipCode" class="" title="邮编">邮编</label>
													</div>
													<div class="ant-col-14 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input value="000000" id="receiverPostCode" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-24 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-5 ant-form-item-label">
														<label for="provinceCityCountry" class="" title="收件人地址">收件人地址</label>
													</div>
													<div class="ant-col-19 ant-form-item-control-wrapper">
														<div class="ant-form-item-control has-success">
															<div style="display: inline-block;">
																<select id="selectRecipientProvinces" style="height: 33px" onchange="getRecipientCity()">
																	<option>请选择</option>
																</select>
																<select id="selectRecipientCity" style="height: 33px" onchange="getRecipientCounty()">
																	<option>请选择</option>
																</select>
																<select id="selectRecipientCounty" style="height: 33px">
																	<option>请选择</option>
																</select>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row info-row">
											<div class="ant-col-24 info-col">
												<div class="ant-row ant-form-item">
													<div class="ant-col-5 ant-form-item-label">
														<label for="addr" class="ant-form-item-required" title="详细地址">详细地址</label>
													</div>
													<div class="ant-col-19 ant-form-item-control-wrapper">
														<div class="ant-form-item-control ">
															<input id="receiverAddress" value="" class="ant-input ant-input-lg" type="text">
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="ant-row">
											<div class="ant-col-24 last-info-col">
												<div class="ant-col-4 last-info-col"></div>
												<div class="ant-col-5 last-info-col"> </div>
												<div class="ant-col-7 last-info-col"> </div>
												<div class="ant-col-3 last-info-col"> </div>
												<div class="ant-col-3 last-info-col"> </div>
												<div class="ant-col-2 last-info-col">
													<button type="button" id="clearRecipient" class="ant-btn ant-btn-primary ant-btn-sm">
														<span>清 空</span>
													</button>
												</div>
											</div>
										</div>
									</form>
								</div>
								<div class="senderAndReceiverTable-div">
									<div>
										<div class="ant-table-wrapper">
											<div class="ant-spin-nested-loading">
												<div class="ant-spin-container">
													<div class="ant-table ant-table-large ant-table-bordered ant-table-empty ant-table-fixed-header ant-table-scroll-position-left">
														<div class="ant-table-content">
															<div class="ant-table-scroll">
																<div class="ant-table-header" style="margin-bottom: -10px;   padding-bottom: 0px;">
																	<table class="ant-table-fixed" style="table-layout: fixed;">
																		<colgroup>
																			<col style="width: 16px; min-width: 16px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 200px; min-width: 200px;">
																			<col style="width: 60px; min-width: 60px;">
																		</colgroup>
																		<thead class="ant-table-thead">
																			<tr>
																				<th class="">
																					<span>
																						<label class="ant-checkbox-wrapper">
																							<span class="ant-checkbox">
																								<input class="ant-checkbox-input" data-type="2" value="on" type="checkbox">
																								<span class="ant-checkbox-inner"></span>
																							</span>
																						</label>
																					</span>
																				</th>
																				<th class=""><span>订单详情</span></th>
																				<th class=""><span>收件人名称</span></th>
																				<th class=""><span>收件人手机</span></th>
																				<th class=""><span>收件人住址</span></th>
																				<th class=""><span>操作</span></th>
																			</tr>
																		</thead>
																		
																																					
																	</table>
																</div>
																<div class="ant-table-body"
																	style="overflow-x: auto; max-height: 100px; overflow-y: scroll;">
																	<table class="ant-table-fixed"
																		style="table-layout: fixed;">
																		<colgroup>
																			<col style="width: 16px; min-width: 16px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 80px; min-width: 80px;">
																			<col style="width: 200px; min-width: 200px;">
																			<col style="width: 60px; min-width: 60px;">
																		</colgroup>
																		<tbody class="ant-table-tbody" id="receiverInfo" >
																		</tbody>
																	</table>
																</div>

															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div>
										<div class="ant-row">
											<div class="ant-col-3"></div>
											<div class="ant-col-3">
												<button disabled="" type="button" class="ant-btn ant-btn-default ant-btn-sm">
													<span>批量删除</span>
												</button>
											</div>
											<div class="ant-col-12">
												<button disabled="" type="button" class="ant-btn ant-btn-primary ant-btn-sm">
													<span>清空选择</span>
												</button>
											</div>
											<div class="ant-col-6">
												<span style="font-size: 15px; font-weight: 900;">已选择
													<span style="color: red;">0</span>/
													<span>0</span>
												</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="ant-row" style="margin-top: 20px">
						<div class="lt-grid-modal-footer">
							<div class="ant-row footer-row">
								<div class="ant-col-9">
									<div><div></div></div>
									<div class="ant-row info-row">
										<div class="ant-col-12 info-col">
											<div class="ant-row ant-form-item">
												<div class="ant-col-10 ant-form-item-label">
													<label for="phone" class="" title="物流单号">物流单号</label>
												</div>
												<div class="ant-col-14 ant-form-item-control-wrapper">
													<div class="ant-form-item-control ">
														<input value="" id="logisticCode" class="ant-input ant-input-lg" type="text">
													</div>
												</div>
											</div>
										</div>
										<div class="ant-col-12 info-col">
											<div class="ant-row ant-form-item">
												<div class="ant-col-10 ant-form-item-label"><label>选择物流</label></div>
												<div class="ant-col-14 ant-form-item-control-wrapper">
													<div class="ant-form-item-control ">
														<span class="customprint-footerbutton-span">
															<select id="selectLogisticsCompany" style="height: 30px">
																<option>请选择</option>
															</select>
														</span>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="ant-col-15">
									<button type="button" id="printExpress" class="ant-btn  lt-btn-active ant-btn-active ant-btn-lg">
										<span>打印快递单</span>
									</button>
									<button type="button" id="entryExpress" style="margin-left: 30px;" class="ant-btn ant-btn-active ant-btn-lg">
										<span style="border-bottom-color: blue;">录入快递单</span>
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="_umfp" style="display: inline; width: 1px; height: 1px; overflow: hidden;"></div>
</body>
</html>